import{q as e,s as t,G as s,n as a,o as l,c as d,w as i,a as o,h as n,b as r,r as u,F as c,j as p,i as f,e as h,N as m,t as _,f as g}from"./index.cfe26b5f.js";import{d as b,_ as j,a as y,b as x,c as V}from"./order.dd437225.js";import{r as k}from"./uni-app.es.e3ab09e6.js";import{c as O}from"./checkLogin.6fe48e50.js";import{s as v,d as w}from"./cart.d9ceeb3a.js";import{_ as C}from"./plugin-vue_export-helper.21dcd24c.js";import"./uni-icons.e166c0cb.js";import"./request.ada75ed3.js";var I=C({data:()=>({address:"",phone:"",goods:[],only:!0,plist:""}),onLoad:function(t){if(t.item)this.goods.push(JSON.parse(decodeURIComponent(t.item))),this.only=!0,this.plist="";else if(t.cid){let s=e("token");this.only=!1,v(s).then((e=>{if(!0===e.status&&e.data.length>0){let s=t.cid.split(",").map(Number);this.goods=e.data.filter((e=>-1!==s.indexOf(e.cid)))}}))}},methods:{_addOrder(){O().then((a=>{if(!0===a.status)if(""===this.address)t({title:"请输入收货地址"});else if(""===this.phone)t({title:"请输入手机号"});else{let a=e("token"),l=(new Date).toISOString().slice(0,19).replace("T"," "),d="",i=0;!0===this.only?(d=this.goods[0].id+"-1",i=this.goods[0].price):!1===this.only&&this.goods.forEach((e=>{d+=","+e.cid+"-"+e.count,i+=e.price})),b(a,d,this.address,this.phone,l,i).then((e=>{if(!0===e.status)return t({title:"添加成功"}),s({url:"/pages/my/my"}),!0})).then((e=>{if(!0===e){let e=this.goods.map((e=>w(a,e.cid)));Promise.all(e)}}))}}))}},toResgister(){a({url:"/pages/register/register"})}},[["render",function(e,t,s,a,b,O){const v=p,w=f,C=k(h("uni-th"),j),I=k(h("uni-tr"),y),N=g,S=k(h("uni-td"),x),U=k(h("uni-table"),V),q=m;return l(),d(w,{class:"order"},{default:i((()=>[o(w,{class:"order-top"},{default:i((()=>[o(v,null,{default:i((()=>[n("添加订单")])),_:1})])),_:1}),o(w,{class:"order-content"},{default:i((()=>[o(U,{border:"",stripe:"",emptyText:"暂无更多数据",style:{"margin-top":"80rpx"}},{default:i((()=>[o(I,null,{default:i((()=>[o(C,{align:"center"},{default:i((()=>[n("图片")])),_:1}),o(C,{align:"center",width:"200rpx"},{default:i((()=>[n("书名")])),_:1}),o(C,{align:"left"},{default:i((()=>[n("价格")])),_:1}),o(C,{align:"left"},{default:i((()=>[n("数量")])),_:1})])),_:1}),(l(!0),r(c,null,u(b.goods,(e=>(l(),d(I,{class:"table-content"},{default:i((()=>[o(S,null,{default:i((()=>[o(N,{src:e.image},null,8,["src"])])),_:2},1024),o(S,null,{default:i((()=>[n(_(e.title),1)])),_:2},1024),o(S,null,{default:i((()=>[n(_(e.price),1)])),_:2},1024),o(S,null,{default:i((()=>[n(_(e.count||1),1)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])),_:1}),o(w,{class:"order-input"},{default:i((()=>[o(w,{class:"input-item"},{default:i((()=>[o(w,{class:"title-content"},{default:i((()=>[n("地址   ")])),_:1}),o(q,{class:"input",placeholder:"收获地址",modelValue:b.address,"onUpdate:modelValue":t[0]||(t[0]=e=>b.address=e)},null,8,["modelValue"])])),_:1}),o(w,{class:"input-item"},{default:i((()=>[o(w,{class:"title-content"},{default:i((()=>[n("手机号")])),_:1}),o(q,{class:"input",placeholder:"手机号",modelValue:b.phone,"onUpdate:modelValue":t[1]||(t[1]=e=>b.phone=e)},null,8,["modelValue"])])),_:1})])),_:1}),o(w,{class:"button",onClick:O._addOrder},{default:i((()=>[n("下订单")])),_:1},8,["onClick"])])),_:1})}],["__scopeId","data-v-bec014de"]]);export{I as default};
