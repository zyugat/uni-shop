var t=Object.defineProperty,e=Object.defineProperties,s=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i,r=(t,e)=>{for(var s in e||(e={}))a.call(e,s)&&n(t,s,e[s]);if(i)for(var s of i(e))o.call(e,s)&&n(t,s,e[s]);return t};import{o as l,c,w as d,A as u,a as h,d as p,h as m,t as f,y as g,z as y,f as k,i as _,j as b,B as C,e as w,C as x,D as T,n as v,q as S,E as $,s as P,G as A,b as j,r as D,F as O,u as B,H as I}from"./index.cfe26b5f.js";import{_ as E}from"./plugin-vue_export-helper.21dcd24c.js";import{r as L}from"./uni-app.es.e3ab09e6.js";import{s as M,_ as Y,a as X,b as z,c as H}from"./order.dd437225.js";import{c as F}from"./checkLogin.6fe48e50.js";import"./uni-icons.e166c0cb.js";/* empty css                                                              */import"./request.ada75ed3.js";var R=E({name:"UniCard",emits:["click"],props:{title:{type:String,default:""},subTitle:{type:String,default:""},padding:{type:String,default:"10px"},margin:{type:String,default:"15px"},spacing:{type:String,default:"0 10px"},extra:{type:String,default:""},cover:{type:String,default:""},thumbnail:{type:String,default:""},isFull:{type:Boolean,default:!1},isShadow:{type:Boolean,default:!0},shadow:{type:String,default:"0px 0px 3px 1px rgba(0, 0, 0, 0.08)"},border:{type:Boolean,default:!0}},methods:{onClick(t){this.$emit("click",t)}}},[["render",function(t,e,s,i,a,o){const n=k,r=_,C=b;return l(),c(r,{class:y(["uni-card",{"uni-card--full":s.isFull,"uni-card--shadow":s.isShadow,"uni-card--border":s.border}]),style:g({margin:s.isFull?0:s.margin,padding:s.spacing,"box-shadow":s.isShadow?s.shadow:""})},{default:d((()=>[u(t.$slots,"cover",{},(()=>[s.cover?(l(),c(r,{key:0,class:"uni-card__cover"},{default:d((()=>[h(n,{class:"uni-card__cover-image",mode:"widthFix",onClick:e[0]||(e[0]=t=>o.onClick("cover")),src:s.cover},null,8,["src"])])),_:1})):p("",!0)]),!0),u(t.$slots,"title",{},(()=>[s.title||s.extra?(l(),c(r,{key:0,class:"uni-card__header"},{default:d((()=>[h(r,{class:"uni-card__header-box",onClick:e[1]||(e[1]=t=>o.onClick("title"))},{default:d((()=>[s.thumbnail?(l(),c(r,{key:0,class:"uni-card__header-avatar"},{default:d((()=>[h(n,{class:"uni-card__header-avatar-image",src:s.thumbnail,mode:"aspectFit"},null,8,["src"])])),_:1})):p("",!0),h(r,{class:"uni-card__header-content"},{default:d((()=>[h(C,{class:"uni-card__header-content-title uni-ellipsis"},{default:d((()=>[m(f(s.title),1)])),_:1}),s.title&&s.subTitle?(l(),c(C,{key:0,class:"uni-card__header-content-subtitle uni-ellipsis"},{default:d((()=>[m(f(s.subTitle),1)])),_:1})):p("",!0)])),_:1})])),_:1}),h(r,{class:"uni-card__header-extra",onClick:e[2]||(e[2]=t=>o.onClick("extra"))},{default:d((()=>[h(C,{class:"uni-card__header-extra-text"},{default:d((()=>[m(f(s.extra),1)])),_:1})])),_:1})])),_:1})):p("",!0)]),!0),h(r,{class:"uni-card__content",style:g({padding:s.padding}),onClick:e[3]||(e[3]=t=>o.onClick("content"))},{default:d((()=>[u(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"]),h(r,{class:"uni-card__actions",onClick:e[4]||(e[4]=t=>o.onClick("actions"))},{default:d((()=>[u(t.$slots,"actions",{},void 0,!0)])),_:3})])),_:3},8,["class","style"])}],["__scopeId","data-v-3d170368"]]);class N{constructor(t,e){this.options=t,this.animation=C(t),this.currentStepAnimates={},this.next=0,this.$=e}_nvuePushAnimates(t,e){let s=this.currentStepAnimates[this.next],i={};if(i=s||{styles:{},config:{}},G.includes(t)){i.styles.transform||(i.styles.transform="");let s="";"rotate"===t&&(s="deg"),i.styles.transform+=`${t}(${e+s}) `}else i.styles[t]=`${e}`;this.currentStepAnimates[this.next]=i}_animateRun(t={},e={}){let s=this.$.$refs.ani.ref;if(s)return new Promise(((i,a)=>{nvueAnimation.transition(s,r({styles:t},e),(t=>{i()}))}))}_nvueNextAnimate(t,e=0,s){let i=t[e];if(i){let{styles:a,config:o}=i;this._animateRun(a,o).then((()=>{e+=1,this._nvueNextAnimate(t,e,s)}))}else this.currentStepAnimates={},"function"==typeof s&&s(),this.isEnd=!0}step(t={}){return this.animation.step(t),this}run(t){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof t&&t()}),this.$.durationTime)}}const G=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function W(t,e){if(e)return clearTimeout(e.timer),new N(t,e)}G.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((t=>{N.prototype[t]=function(...e){return this.animation[t](...e),this}}));var Z=E({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(t){t?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let t=(i=r({},this.styles),a={"transition-duration":this.duration/1e3+"s"},e(i,s(a)));var i,a;let o="";for(let e in t){o+=this.toLine(e)+":"+t[e]+";"}return o},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(t={}){t.duration&&(this.durationTime=t.duration),this.animation=W(Object.assign(this.config,t),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(t,e={}){if(this.animation){for(let e in t)try{"object"==typeof t[e]?this.animation[e](...t[e]):this.animation[e](t[e])}catch(s){console.error(`方法 ${e} 不存在`)}return this.animation.step(e),this}},run(t){this.animation&&this.animation.run(t)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:t,transform:e}=this.styleInit(!1);void 0!==t&&(this.opacity=t),this.transform=e,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=W(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(t){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:t,transform:e}=this.styleInit(!1);this.opacity=t||1,this.transform=e,this.$emit("change",{detail:this.isShow})}))},styleInit(t){let e={transform:""},s=(t,s)=>{"fade"===s?e.opacity=this.animationType(t)[s]:e.transform+=this.animationType(t)[s]+" "};return"string"==typeof this.modeClass?s(t,this.modeClass):this.modeClass.forEach((e=>{s(t,e)})),e},tranfromInit(t){let e=(t,e)=>{let s=null;"fade"===e?s=t?0:1:(s=t?"-100%":"0","zoom-in"===e&&(s=t?.8:1),"zoom-out"===e&&(s=t?1.2:1),"slide-right"===e&&(s=t?"100%":"0"),"slide-bottom"===e&&(s=t?"100%":"0")),this.animation[this.animationMode()[e]](s)};return"string"==typeof this.modeClass?e(t,this.modeClass):this.modeClass.forEach((s=>{e(t,s)})),this.animation},animationType:t=>({fade:t?1:0,"slide-top":`translateY(${t?"0":"-100%"})`,"slide-right":`translateX(${t?"0":"100%"})`,"slide-bottom":`translateY(${t?"0":"100%"})`,"slide-left":`translateX(${t?"0":"-100%"})`,"zoom-in":`scaleX(${t?1:.8}) scaleY(${t?1:.8})`,"zoom-out":`scaleX(${t?1:1.2}) scaleY(${t?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:t=>t.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(t,e,s,i,a,o){const n=_;return a.isShow?(l(),c(n,{key:0,ref:"ani",animation:a.animationData,class:y(s.customClass),style:g(o.transformStyles),onClick:o.onClick},{default:d((()=>[u(t.$slots,"default")])),_:3},8,["animation","class","style","onClick"])):p("",!0)}]]);var U=E({name:"uniPopup",components:{keypress:{name:"Keypress",props:{disable:{type:Boolean,default:!1}},mounted(){const t={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]};document.addEventListener("keyup",(e=>{if(this.disable)return;const s=Object.keys(t).find((s=>{const i=e.key,a=t[s];return a===i||Array.isArray(a)&&a.includes(i)}));s&&setTimeout((()=>{this.$emit(s,{})}),0)}))},render:()=>{}}},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"}},watch:{type:{handler:function(t){this.config[t]&&this[this.config[t]](!0)},immediate:!0},isDesktop:{handler:function(t){this.config[t]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(t){this.mkclick=t},immediate:!0},isMaskClick:{handler:function(t){this.mkclick=t},immediate:!0},showPopup(t){document.getElementsByTagName("body")[0].style.overflow=t?"hidden":"visible"}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:this.isDesktop?"fixforpc-top":"top"}},computed:{isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:t,windowHeight:e,windowTop:s,safeArea:i,screenHeight:a,safeAreaInsets:o}=T();this.popupWidth=t,this.popupHeight=e+(s||0),i&&this.safeArea?this.safeAreaInsets=o.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(){document.getElementsByTagName("body")[0].style.overflow="visible"},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(t){t.stopPropagation(),this.clearPropagation=!0},open(t){this.showPopup&&(clearTimeout(this.timer),this.showPopup=!1);t&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(t)||(t=this.type),this.config[t]?(this[this.config[t]](),this.$emit("change",{show:!0,type:t})):console.error("缺少类型：",t)},close(t){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(t){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg},t||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(t){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets+"px",backgroundColor:this.bg},t||(this.showPopup=!0,this.showTrans=!0)},center(t){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center"},t||(this.showPopup=!0,this.showTrans=!0)},left(t){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},t||(this.showPopup=!0,this.showTrans=!0)},right(t){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},t||(this.showPopup=!0,this.showTrans=!0)}}},[["render",function(t,e,s,i,a,o){const n=L(w("uni-transition"),Z),r=_,m=x("keypress");return a.showPopup?(l(),c(r,{key:0,class:y(["uni-popup",[a.popupstyle,o.isDesktop?"fixforpc-z-index":""]])},{default:d((()=>[h(r,{onTouchstart:o.touchstart},{default:d((()=>[a.maskShow?(l(),c(n,{key:"1",name:"mask","mode-class":"fade",styles:a.maskClass,duration:a.duration,show:a.showTrans,onClick:o.onTap},null,8,["styles","duration","show","onClick"])):p("",!0),h(n,{key:"2","mode-class":a.ani,name:"content",styles:a.transClass,duration:a.duration,show:a.showTrans,onClick:o.onTap},{default:d((()=>[h(r,{class:y(["uni-popup__wrapper",[a.popupstyle]]),style:g({backgroundColor:o.bg}),onClick:o.clear},{default:d((()=>[u(t.$slots,"default",{},void 0,!0)])),_:3},8,["style","class","onClick"])])),_:3},8,["mode-class","styles","duration","show","onClick"])])),_:3},8,["onTouchstart"]),a.maskShow?(l(),c(m,{key:0,onEsc:o.onTap},null,8,["onEsc"])):p("",!0)])),_:3},8,["class"])):p("",!0)}],["__scopeId","data-v-30a0ef24"]]);var q=E({data:()=>({user:{name:"未登录"},order:[],orderGoods:{},orderText:{}}),onShow(){this.init()},methods:{init(){F().then((t=>!1!==t.status?(this.user=t.data,!0):(this.user.name="未登录",v({url:"/pages/login/login"}),!1))).then((t=>{if(!0===t){let t=S("token");M(t).then((t=>{this.order=t.data}))}}))},bLogin(){v({url:"/pages/login/login"})},bResgiter(){v({url:"/pages/register/register"})},bLogout(){$("token"),P({title:"注销成功，返回首页"}),A({url:"/pages/index/index"})},tOrderTitle:t=>t[0].map((t=>t.title.length>6?t.title.slice(0,7)+"...":t.title)).join(" 和 "),orderMsg(t){this.orderGoods=t[0],this.orderText=t[1],this.$refs.popup.open("bottom")}},components:["cart-item"]},[["render",function(t,e,s,i,a,o){const n=b,r=L(w("uni-card"),R),u=B,g=_,y=k,C=L(w("uni-th"),Y),x=L(w("uni-tr"),X),T=L(w("uni-td"),z),v=L(w("uni-table"),H),S=I,$=L(w("uni-popup"),U);return l(),c(g,{class:"my"},{default:d((()=>[h(r,null,{default:d((()=>[h(n,null,{default:d((()=>[m("你好用户："+f(a.user.name),1)])),_:1})])),_:1}),h(r,{title:"登录设置",extra:"选项"},{default:d((()=>[h(g,{class:"my-status"},{default:d((()=>[a.user.uid?p("",!0):(l(),c(u,{key:0,onClick:o.bLogin},{default:d((()=>[m("登录")])),_:1},8,["onClick"])),h(u,{onClick:o.bResgiter},{default:d((()=>[m("注册")])),_:1},8,["onClick"]),h(u,{onClick:o.bLogout},{default:d((()=>[m("登出")])),_:1},8,["onClick"])])),_:1})])),_:1}),h(r,null,{default:d((()=>[h(n,null,{default:d((()=>[m("您的订单数量："+f(this.order.length),1)])),_:1})])),_:1}),(l(!0),j(O,null,D(a.order,(t=>(l(),c(g,{class:"order"},{default:d((()=>[h(r,{title:t[1].oid,onClick:e=>o.orderMsg(t),class:"order-item"},{default:d((()=>[h(y,{slot:"cover",src:t[0][0].image},null,8,["src"]),h(g,null,{default:d((()=>[m("该订单含有 "+f(t[0].length)+" 本书",1)])),_:2},1024),h(g,null,{default:d((()=>[m("书名为："+f(o.tOrderTitle(t)),1)])),_:2},1024),h(g,null,{default:d((()=>[m("目前订单状态处于："+f(t[1].status),1)])),_:2},1024),h(g,null,{default:d((()=>[m("点击图片可以查看更多信息")])),_:1})])),_:2},1032,["title","onClick"])])),_:2},1024)))),256)),h(g,null,{default:d((()=>[h($,{ref:"popup","background-color":"#fff"},{default:d((()=>[h(g,{class:"popup-content"},{default:d((()=>[h(g,{class:"oid"},{default:d((()=>[m("订单编号："+f(a.orderText.oid),1)])),_:1}),h(g,{class:"address"},{default:d((()=>[m("收货地址："+f(a.orderText.address),1)])),_:1}),h(g,{class:"phone"},{default:d((()=>[m("手机号："+f(a.orderText.phone),1)])),_:1}),h(g,{class:"time"},{default:d((()=>[m("下单时间："+f(a.orderText.time),1)])),_:1}),h(g,{class:"price"},{default:d((()=>[m("总价格："+f(a.orderText.total),1)])),_:1}),h(g,{class:"status"},{default:d((()=>[m("目前状态："+f(a.orderText.status),1)])),_:1}),h(g,{class:"tracking"},{default:d((()=>[m("快递单号："+f(a.orderText.tracking),1)])),_:1}),h(S,{"scroll-y":"true",class:"scroll-Y"},{default:d((()=>[h(v,{border:"",stripe:"",emptyText:"暂无更多数据"},{default:d((()=>[h(x,null,{default:d((()=>[h(C,{align:"center"},{default:d((()=>[m("图片")])),_:1}),h(C,{align:"center",width:"200rpx"},{default:d((()=>[m("书名")])),_:1}),h(C,{align:"left"},{default:d((()=>[m("价格")])),_:1}),h(C,{align:"left"},{default:d((()=>[m("数量")])),_:1})])),_:1}),(l(!0),j(O,null,D(a.orderGoods,(t=>(l(),c(x,{class:"popup-cart-content"},{default:d((()=>[h(T,null,{default:d((()=>[h(y,{src:t.image},null,8,["src"])])),_:2},1024),h(T,null,{default:d((()=>[m(f(t.title),1)])),_:2},1024),h(T,null,{default:d((()=>[m(f(t.price),1)])),_:2},1024),h(T,null,{default:d((()=>[m(f(t.count),1)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})])),_:1})}],["__scopeId","data-v-220881a0"]]);export{q as default};
